diff --git a/configure b/configure
index d25eec56..50058520 100755
--- a/configure
+++ b/configure
@@ -747,8 +747,7 @@ if [ -z "$OPEN_MEMSTREAM" ]; then
 	cat <<EOF >_open_memstream.c
 #include <stdio.h>
 int main(void) {
-	open_memstream(NULL, NULL);
-	return 0;
+	return open_memstream(NULL, NULL) != NULL ? 0 : 1;
 }
 EOF
 	if $XCC _open_memstream.c -o _open_memstream 2>&3; then
