From 1109c9d9c542d96bb48889f4c6e334d8337386ba Mon Sep 17 00:00:00 2001
From: Lars Wendler <polynomial-c@gentoo.org>
Date: Thu, 30 Apr 2020 18:32:44 +0200
Subject: [PATCH 1/2] Makefile: Respect CC, CFLAGS and LDFLAGS variables

---
 Makefile | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/Makefile b/Makefile
index 6a0e2b2..3c847b0 100644
--- a/Makefile
+++ b/Makefile
@@ -1,4 +1,5 @@
 NAME=upd72020x-load
+CC ?= gcc
 
 .PHONY: all clean
 
@@ -8,4 +9,4 @@ clean:
 	rm $(NAME)
 
 $(NAME): upd72020x-load.c
-	gcc -o $@ $^
+	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $^
-- 
2.26.2


From 57c74e0611171a04743922d5e18d6d141f6303ba Mon Sep 17 00:00:00 2001
From: Lars Wendler <polynomial-c@gentoo.org>
Date: Thu, 30 Apr 2020 18:36:50 +0200
Subject: [PATCH 2/2] upd72020x-load.c: open() with O_CREAT requires three
 arguments

Adding file mode with 0644
---
 upd72020x-load.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/upd72020x-load.c b/upd72020x-load.c
index 2c1adbc..f42a585 100644
--- a/upd72020x-load.c
+++ b/upd72020x-load.c
@@ -230,7 +230,7 @@ int read_eeprom(int fd, char *filename, unsigned int len) {
     int ofile;
     u_int ix, data01, jx, val32, status;
 
-    ofile = open(filename, O_CREAT | O_RDWR | O_TRUNC);
+    ofile = open(filename, O_CREAT | O_RDWR | O_TRUNC, 0644);
 
     RETURN_ON_ERR(ofile < 0, "ERROR: cant open file %s\n", filename);
 
-- 
2.26.2

